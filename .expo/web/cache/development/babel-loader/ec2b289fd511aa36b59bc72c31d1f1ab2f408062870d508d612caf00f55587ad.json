{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/toConsumableArray\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useEffect, useState, useCallback } from \"react\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport View from \"react-native-web/dist/exports/View\";\nimport { useNavigation, useRoute, useFocusEffect } from '@react-navigation/native';\nimport axios from 'axios';\nimport Back from \"../../assets/back.svg\";\nimport { Level } from \"../../components/Level\";\nimport { Header } from \"../../components/Header\";\nimport { QuizCard } from \"../../components/QuizCard\";\nimport { styles } from \"./styles\";\nimport { QUIZZES } from \"../../data/quizzes\";\nimport { allMateri } from \"../../data/materi\";\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { jsx as _jsx, jsxs as _jsxs } from \"react/jsx-runtime\";\nexport function Home() {\n  var _useState = useState(QUIZZES),\n    _useState2 = _slicedToArray(_useState, 2),\n    quizzes = _useState2[0],\n    setQuizzes = _useState2[1];\n  var _useState3 = useState([1, 2, 3]),\n    _useState4 = _slicedToArray(_useState3, 2),\n    levels = _useState4[0],\n    setLevels = _useState4[1];\n  var _useState5 = useState([]),\n    _useState6 = _slicedToArray(_useState5, 2),\n    grades = _useState6[0],\n    setGrades = _useState6[1];\n  var route = useRoute();\n  var id = route.params.id;\n  var _useState7 = useState(function () {\n      return allMateri.find(function (materi) {\n        return materi.id === id;\n      });\n    }),\n    _useState8 = _slicedToArray(_useState7, 2),\n    selectedMateri = _useState8[0],\n    setSelectedMateri = _useState8[1];\n  var _useNavigation = useNavigation(),\n    navigate = _useNavigation.navigate;\n  function handleLevelFilter(level) {\n    var levelAlreadySelected = levels.includes(level);\n    if (levelAlreadySelected) {\n      if (levels.length > 1) {\n        setLevels(function (prevState) {\n          return prevState.filter(function (item) {\n            return item !== level;\n          });\n        });\n      }\n    } else {\n      setLevels(function (prevState) {\n        return [].concat(_toConsumableArray(prevState), [level]);\n      });\n    }\n  }\n  useEffect(function () {\n    setSelectedMateri(allMateri.find(function (materi) {\n      return materi.id === id;\n    }));\n  }, [id]);\n  useEffect(function () {\n    console.log(\"selectedMateri:\", selectedMateri);\n    setQuizzes(QUIZZES.filter(function (quiz) {\n      return levels.includes(quiz.level) && quiz.title === (selectedMateri == null ? void 0 : selectedMateri.title);\n    }));\n  }, [levels, selectedMateri]);\n  useEffect(function () {\n    var fetchUserIdAndGrades = function () {\n      var _ref = _asyncToGenerator(function* () {\n        try {\n          var userId = yield AsyncStorage.getItem('userId');\n          console.log('userId:Home', userId);\n          if (userId) {\n            console.log('userId:', userId);\n            var response = yield axios.get(`https://server-side-quiz-react-native.vercel.app/grade/user/${userId}`);\n            setGrades(response.data);\n            console.log('grades:', response.data);\n          }\n        } catch (error) {\n          console.error('Error fetching user id or grades:', error.response.status);\n        }\n      });\n      return function fetchUserIdAndGrades() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n    fetchUserIdAndGrades();\n  }, [selectedMateri]);\n  useFocusEffect(useCallback(function () {\n    return function () {\n      route.params.id = null;\n      setSelectedMateri(null);\n    };\n  }, [route.params]));\n  var checkAttempted = function checkAttempted(quizId) {\n    var result = grades.some(function (grade) {\n      return grade.quizId === quizId;\n    });\n    return result;\n  };\n  return _jsxs(View, {\n    style: styles.container,\n    children: [_jsx(Header, {\n      icon1: Back,\n      icon2: null,\n      title: selectedMateri == null ? void 0 : selectedMateri.title,\n      subtitle: \"Treine seus conhecimento\",\n      onPress: function onPress() {\n        return navigate('history');\n      }\n    }), _jsxs(View, {\n      style: styles.levels,\n      children: [_jsx(Level, {\n        title: \"Mudah\",\n        type: \"EASY\",\n        onPress: function onPress() {\n          return handleLevelFilter(1);\n        },\n        isChecked: levels.includes(1)\n      }), _jsx(Level, {\n        title: \"Sedang\",\n        type: \"MEDIUM\",\n        onPress: function onPress() {\n          return handleLevelFilter(2);\n        },\n        isChecked: levels.includes(2)\n      }), _jsx(Level, {\n        title: \"Sulit\",\n        type: \"HARD\",\n        onPress: function onPress() {\n          return handleLevelFilter(3);\n        },\n        isChecked: levels.includes(3)\n      })]\n    }), _jsx(FlatList, {\n      data: quizzes,\n      keyExtractor: function keyExtractor(item) {\n        return item.id;\n      },\n      renderItem: function renderItem(_ref2) {\n        var item = _ref2.item,\n          index = _ref2.index;\n        return _jsx(QuizCard, {\n          index: index,\n          data: item,\n          attempted: checkAttempted(item.id),\n          grades: grades,\n          onPress: function onPress() {\n            return navigate('quiz', {\n              id: item.id\n            });\n          }\n        });\n      },\n      numColumns: 2,\n      showsVerticalScrollIndicator: false,\n      contentContainerStyle: styles.cards\n    })]\n  });\n}","map":{"version":3,"names":["React","useEffect","useState","useCallback","FlatList","View","useNavigation","useRoute","useFocusEffect","axios","Back","Level","Header","QuizCard","styles","QUIZZES","allMateri","AsyncStorage","jsx","_jsx","jsxs","_jsxs","Home","_useState","_useState2","_slicedToArray","quizzes","setQuizzes","_useState3","_useState4","levels","setLevels","_useState5","_useState6","grades","setGrades","route","id","params","_useState7","find","materi","_useState8","selectedMateri","setSelectedMateri","_useNavigation","navigate","handleLevelFilter","level","levelAlreadySelected","includes","length","prevState","filter","item","concat","_toConsumableArray","console","log","quiz","title","fetchUserIdAndGrades","_ref","_asyncToGenerator","userId","getItem","response","get","data","error","status","apply","arguments","checkAttempted","quizId","result","some","grade","style","container","children","icon1","icon2","subtitle","onPress","type","isChecked","keyExtractor","renderItem","_ref2","index","attempted","numColumns","showsVerticalScrollIndicator","contentContainerStyle","cards"],"sources":["C:/quizApp-ReactNative/src/screens/Home/index.tsx"],"sourcesContent":["import React, { useEffect, useState, useCallback } from \"react\";\r\nimport { FlatList, View } from 'react-native';\r\nimport { useNavigation, useRoute, useFocusEffect } from '@react-navigation/native';\r\nimport axios from 'axios';\r\nimport Back from \"../../assets/back.svg\";\r\n\r\nimport { Level } from '../../components/Level';\r\nimport { Header } from '../../components/Header';\r\nimport { QuizCard } from '../../components/QuizCard';\r\n\r\nimport { styles } from './styles';\r\nimport { QUIZZES } from '../../data/quizzes';\r\nimport { allMateri } from \"../../data/materi\";\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\n\r\nexport function Home() {\r\n  const [quizzes, setQuizzes] = useState(QUIZZES);\r\n  const [levels, setLevels] = useState([1, 2, 3]);\r\n  const [grades, setGrades] = useState([]);\r\n  const route = useRoute();\r\n  const { id } = route.params;\r\n  const [selectedMateri, setSelectedMateri] = useState(() => allMateri.find(materi => materi.id === id));\r\n\r\n  const { navigate } = useNavigation();\r\n\r\n  function handleLevelFilter(level: number) {\r\n    const levelAlreadySelected = levels.includes(level);\r\n\r\n    if (levelAlreadySelected) {\r\n      if (levels.length > 1) {\r\n        setLevels(prevState => prevState.filter(item => item !== level));\r\n      }\r\n    } else {\r\n      setLevels(prevState => [...prevState, level]);\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    setSelectedMateri(allMateri.find(materi => materi.id === id));\r\n  }, [id]);\r\n\r\n  useEffect(() => {\r\n    console.log(\"selectedMateri:\", selectedMateri);\r\n\r\n    setQuizzes(QUIZZES.filter(quiz => levels.includes(quiz.level) && quiz.title === selectedMateri?.title));\r\n  }, [levels, selectedMateri]);\r\n\r\n  // Get userId from AsyncStorage and fetch grades\r\n  useEffect(() => {\r\n    const fetchUserIdAndGrades = async () => {\r\n      try {\r\n        const userId = await AsyncStorage.getItem('userId');\r\n        console.log('userId:Home', userId);\r\n\r\n        if (userId) {\r\n          console.log('userId:', userId);\r\n\r\n          const response = await axios.get(`https://server-side-quiz-react-native.vercel.app/grade/user/${userId}`);\r\n          setGrades(response.data);\r\n          console.log('grades:', response.data);\r\n        }\r\n      } catch (error) {\r\n        console.error('Error fetching user id or grades:', error.response.status);\r\n      }\r\n    };\r\n    fetchUserIdAndGrades();\r\n  }, [selectedMateri]);\r\n\r\n  useFocusEffect(\r\n    useCallback(() => {\r\n      return () => {\r\n        route.params.id = null; // Reset the id parameter when unfocusing\r\n        setSelectedMateri(null);\r\n      };\r\n    }, [route.params])\r\n  );\r\n\r\n  const checkAttempted = (quizId) => {\r\n    const result = grades.some(grade => grade.quizId === quizId);\r\n\r\n    return result;\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <Header\r\n        icon1={Back}\r\n        icon2={null}\r\n        title={selectedMateri?.title}\r\n        subtitle=\"Treine seus conhecimento\"\r\n        onPress={() => navigate('history')}\r\n      />\r\n\r\n      <View style={styles.levels}>\r\n        <Level title=\"Mudah\" type=\"EASY\" onPress={() => handleLevelFilter(1)} isChecked={levels.includes(1)} />\r\n        <Level title=\"Sedang\" type=\"MEDIUM\" onPress={() => handleLevelFilter(2)} isChecked={levels.includes(2)} />\r\n        <Level title=\"Sulit\" type=\"HARD\" onPress={() => handleLevelFilter(3)} isChecked={levels.includes(3)} />\r\n      </View>\r\n\r\n      <FlatList\r\n        data={quizzes}\r\n        keyExtractor={item => item.id}\r\n        renderItem={({ item, index }) => (\r\n          <QuizCard\r\n            index={index}\r\n            data={item}\r\n            attempted={checkAttempted(item.id)}\r\n            grades={grades} // Pass the grades data as a prop\r\n            onPress={() => navigate('quiz', { id: item.id })}\r\n          />\r\n        )}\r\n        numColumns={2}\r\n        showsVerticalScrollIndicator={false}\r\n        contentContainerStyle={styles.cards}\r\n      />\r\n    </View>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}